\section{Коды аутентификации сообщений. Хеш-функции.}

\subsection{Коды аутентификации сообщений. }

Для обеспечения целостности и подтверждения авторства информации, передаваемой по каналу связи, используют имитовставку MAC (англ. Message Authentication Code).
Имитовставкой называется криптографическая хэш-функция $MAC(K,m)$, зависящая от передаваемого сообщения m и секретного ключа K отправителя A, обладающая свойствами цифровой подписи:

\begin{itemize}
\item получатель B, используя такой же или другой ключ, имеет возможность проверить целостность и доказать принадлежность информации A;

\item имитовставку невозможно фальсифицировать.
\end{itemize}

Наиболее универсальный способ аутентификации сообщений через схемы ЭП на криптосистемах с открытым ключом состоит в том, что сторона A отправляет стороне B сообщение
$$
m \parallel \text{ЭП}(K,h(m)))
$$
Но для больших данных долго поэтому, 
$$
m \parallel MAC(K,m)
$$
Зная секретный ключ K, получатель B может удостовериться с помощью кода аутентификации, что информация не была измене- на или фальсифицирована, а была создана отправителем.
Требования к длине кода аутентификации в общем случае такие же, как и для криптографической хэш-функции, то есть длина должна быть не менее 160–256 бит. На практике часто используют усеченные имитовставки.
\\
Стандартные способы использования имитовставки сообщения следующие:
\begin{itemize}
\item Если шифрование данных не применяется, отправитель A
для каждого пакета информации m отсылает сообщение
$$
m \parallel MAC(K,m)
$$
\item Если используется шифрование данных симметричной криптосистемой с помощью ключа $K_e$, то имитовставка с ключом $K_a$ может вычисляться как до, так и после шифрования:
$$
E_{K_e} (m) \parallel MAC(K_a, E_{K_e}(m)) \text{ или }  E_{K_e} (m \parallel MAC(K_a,m))
$$
\end{itemize}
Имитовставка на основе хэш-функции обозначается HMAC
(Hash-based MAC) и стандартно вычисляется в виде:
$$
HMAC(K,m) = H(K \parallel H(K\parallel m))
$$
\subsection{Хэш-функция. Коллизия. }
Хэш-функциеи? (англ. hash function) называется отображение, переводящее аргумент произвольной длины в значение фиксированной длины.
Коллизией хэш-функции называется пара значений аргумента, дающая одинаковый выход хэш-функции. Коллизии есть у любых хэш-функций, если количество различных значении? аргумента превышает возможное количество значении? результата функции (принцип Дирихле). А если не превышает, то и нет смысла использовать хэш-функцию.

В программировании к свойствам хорошей хэш-функции относят:
\begin{itemize}
\item быструю скорость работы;
\item минимальное число коллизий.
\end{itemize}

Криптографически стойкой хэш-функцией $H(x)$	 называется хэш-функция, имеющая следующие свойства: 

\begin{itemize}
\item однонаправленность: вычислительно невозможно по значению функции найти прообраз;
\item слабая устойчивость к коллизиям (слабо бесконфликтная функция): для заданного аргумента $x$ вычислительно невозможно найти другой аргумент $y \neq x : H(x) = H(y)$;
\item сильная устойчивость к коллизиям (сильно бесконфликтная функция): вычислительно невозможно найти пару разных аргументов $y \neq x : H(x) = H(y)$.
\end{itemize}

Если k -битовая криптографическая хэш-функция имеет равномерное распределение выходных хэш-значении? по всем сообщениям, то, согласно парадоксу дней рождения (см. раздел А.2 в приложении), среди 
$$
n _{1/2} \approx \sqrt{2\ln2}\cdot 2^{k/2}
$$

случайных сообщений с вероятностью больше 1/2 найдутся два сообщения с одинаковыми значениями хэш-функций, то есть произойдет коллизия.
Криптографические хэш-функции должны быть равномерными по выходу, насколько это можно проверить, чтобы быть устойчивыми к коллизиям. Следовательно, для нахождения коллизии нужно взять группу из примерно $2^{k/2}$ сообщений. 


