\section{БЛОЧНЫЕ ШИФРЫ. Ячейка Фейстеля. Лавинный эффект.Шифр DES.}

\subsection{БЛОЧНЫЕ ШИФРЫ}

Блочные шифры можно рассматривать как функцию преобразования строки фиксированнои? длины в строку аналогичной длины с использованием некоторого ключа, а также соответствующую ей функцию расшифрования:

$$
C = E_K (M), 
$$
$$
M' = D_K(C)
$$

Данные функции необходимо дополнить требованиями корректности, производительности и надежности. Во-первых, функция расшифрования должна однозначно восстанавливать произвольное исходное сообщение:

$$
\forall k \in K, m \in M \rightarrow D_k (E_k(m)) = m 
$$
Во-вторых, функции шифрования и расшифрования должны быть вычислительно простыми для легальных пользователей (знающих клейч). В-третьих, должно быть невозможно найти открытый текст сообщения по шифртексту без знания ключа, кроме как полным перебором всех возможных ключей расшифрования. Так- же, что менее очевидно, надежная функция блочного шифра не должна давать возможность найти ключ шифрования (расшифрования), даже если злоумышленнику известны пары открытого текста и шифртекста.

\subsection{Ячейка Фейстиля}
\begin{figure}[h!]
\begin{center}
\includegraphics[width=9cm]{questions/img/6_2_1.png}
\end{center}
\end{figure}

На рис. 5.5 изображен один раунд шифрования блочного шифра, использующего оригинальную ячейку Феи?стеля. Каждый раунд шифрования принимает на вход блок с четным количеством бит и делит его на две равные части $L_k$ и $R_k$.  Входным блоком для первого раунда является блок открытого текста. Правая часть $R_k$ без изменений становится левой частью входного блока $L_{k+1}$ следующего раунда шифрования. Кроме того, правая часть подается на вход функции Феи?стеля $F(R_k,K_k)$, аргументами которой являются половина блока данных и раундовый ключ. Результат работы функции Фейстеля складывается с помощью побитового сложения по модулю 2 с левой частью входного блока  $L_k$ Полученная последоваельность бит становится правой частью выходного блока раунда шифрования.

\subsection{Лавинный эффект.}
Также надежные блочные шифры обладают лавинным эффектом (англ. avalanche effect): изменение одного бита в блоке от крытого текста или ключа приводит к полному изменению соответствующего блока шифртекста.

\subsection{Шифр DES.}
В шифре DES открытый текст делится на блоки по 32 бита, и они обрабатываются в 16 раундах. Раундовые ключи генерируются из исходных 64 бит ключа (при этом значащими являются только 56 бит, а последние 8 бит используются для проверки корректности ввода ключа). На вход функции Фейстеля для шифра DES, схема которой приведена на рис. 5.6, подается половина от размера входного блока – 32 бита.

\begin{figure}[h!]
\begin{center}
\includegraphics[width=13cm]{questions/img/6_4_1.png}
\end{center}
\end{figure}

Эти 32 бита проходят через функцию расширения, которая с помощью дублирования отдельных битов превращает их в 48 бит. Они суммируются побитово по модулю 2 с раундовым ключом. Результат подается на вход 8 s-блоков, которые работают как таблицы замен последовательности из 6 бит в 4 бита (каждый блок).
На выходе $s$ - блоков получается $8 \times 4 = 32$ бита,  которые попадают в p-блок перестановки. Результат работы p-блока является результатом функции Фейстеля для одного раунда шифра DES.