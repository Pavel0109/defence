\section{AES. Режимы работы.}

\subsection{AES}

AES – это раундовый блочный шифр с переменной длиной ключа (128, 192 или 256 бит) и фиксированными длинами входного и выходного блоков (128 бит).

Состояние -- матрица $4 \times 4$ из байтов $a_{i,j}$.
Ключ шифрования раунда (Key) --  $(4 \times Nk)$, где Nk равно длине ключа разделенной на 32, то есть 4,6 или 8.

Входные и выходные блоки шифра AES рассматриваются как последовательности 16 байтов 

В каждом раунде шифра AES, кроме последнего, производятся следующие 4 операции:
\begin{itemize}

\item замена байтов SubBytes;
\item сдвиг строк ShiftRows;
\item перемешивание столбцов MixColumns;
\item добавление текущего ключа, AddRoundKey.
\end{itemize}

Нелинейная операция <<\textbf{замена байтов}>> действует независимо на каждый байт текущего состояния. Таблица замены (или s - блок) является обратимой и формируется последовательным применением двух преобразований.

Для выполнения операции <<сдвиг строк>> строки в таблице текущего состояния циклически сдвигаются влево. Величина сдвига различна для различных строк.

\subsection{Процедура расширения ключа}
Матрица ключа текущего раунда вычисляется из исходного ключа шифра с помощью специальной процедуры, состоящей из расширения ключа и выбора раундового ключа. Основные принципы этой процедуры состоят в следующем:

суммарная длина ключей всех раундов равна длине блока, умноженной на увеличенное на 1 число раундов. Для блока длины 128 бит и 10 раундов общая длина всех ключей раундов равна 1408;

с помощью ключа шифра находят расширенный ключ;

ключи раунда выбираются из расширенного ключа по правилу: ключ первого раунда состоит из первых 4 столбцов матрицы расширенного ключа, второй ключ – из следующих 4 столбцов и т. д.