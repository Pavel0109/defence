\section{ГОСТ 28147-89. Режимы работы.}

\subsection{ГОСТ 28147-89}

Основные параметры шифра таковы: размер блока составляет 64 бита, число раундов $m = 32$, имеется 8 ключей по 32 бита каждый, так что общая длина ключа – 256 бит. Основа алгоритма – цепочка ячеек Фейстеля. 

Структурная схема алгоритма шифрования представлена на рис. 5.7 и включает:
\begin{itemize}
\item ключевое запоминающее устройство (КЗУ) на 256 бит, которое состоит из восьми 32-разрядных накопителей ($X_0,X_1,X_2,X_3,X_4,X_5,X_6,X_7$) и содержит сеансовые ключи шифрования одного раунда;


\begin{figure}[h!]
\begin{center}
\includegraphics[width=13cm]{questions/img/7_1_1.png}
\end{center}
\end{figure}

\item 32-разрядный сумматор $\boxplus$ по модулю $2^32$;

\item сумматор $\bigoplus$ по модулю 2;

\item блок подстановки (S)

\item регистр циклического сдвига на одиннадцать шагов в сторону старшего разряда (R) 
\end{itemize}

Блок подстановки (S) состоит из 8 узлов замены -- s-блоков с памятью на 64 бита каждый.  Поступающий на вход блока подстановки 32-разрядный вектор разбивается на 8 последовательных 4-разрядных векторов, каждый из которых преобразуется в 4-разрядный вектор соответствующим узлом замены. Узел замены представляет собой таблицу из 16 строк, содержащих по 4 бита в строке. Входной вектор определяет адрес строки в таблице, заполнение данной строки является выходным вектором. Затем 4-разрядные выходные векторы последовательно объединяются в 32-разрядный вектор.
При перезаписи информации содержимое i-го разряда одного накопителя переписывается в i-й разряд другого накопителя.
Ключ, определяющий заполнение КЗУ, и таблицы блока подстановки K являются секретными элементами.
\subsection{Режим работы}
Алгоритм имеет четыре режима работы:
\begin{itemize}
\item простой замены

\item гаммирования

\item гаммирования с обратной связью

\item выработки имитовставки
\end{itemize}